<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Lda - Eigenvector Research Documentation Wiki</title>



    <link rel="stylesheet" href="load.css" media="screen" />        
  

<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href=""/>
<meta name="generator" content="MediaWiki 1.39.6"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="viewport" content="width=1000"/>
<link rel="icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Eigenvector Research Documentation Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://www.wiki.eigenvector.com/api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="Eigenvector Research Documentation Wiki Atom feed" href=""/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Lda rootpage-Lda skin-vector action-view skin-vector-legacy vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading"><a href="https://wiki.eigenvector.com/index.php?title=Lda"><span class="mw-page-title-main">Lda</span></a></h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Eigenvector Research Documentation Wiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Purpose"><span class="tocnumber">1</span> <span class="toctext">Purpose</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Synopsis"><span class="tocnumber">2</span> <span class="toctext">Synopsis</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Description"><span class="tocnumber">3</span> <span class="toctext">Description</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Probability_Estimation_and_Classification"><span class="tocnumber">3.1</span> <span class="toctext">Probability Estimation and Classification</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Inputs"><span class="tocnumber">3.2</span> <span class="toctext">Inputs</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Optional_Inputs"><span class="tocnumber">3.3</span> <span class="toctext">Optional Inputs</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Outputs"><span class="tocnumber">3.4</span> <span class="toctext">Outputs</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Options"><span class="tocnumber">4</span> <span class="toctext">Options</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#See_Also"><span class="tocnumber">5</span> <span class="toctext">See Also</span></a></li>
</ul>
</div>

<h3><span class="mw-headline" id="Purpose">Purpose</span></h3>
<p>Linear Discriminant Analysis.
</p>
<h3><span class="mw-headline" id="Synopsis">Synopsis</span></h3>
<dl><dd>lda - Launches an Analysis window with the LDA method selected</dd>
<dd>model = lda(x,y,ncomp,options)</dd>
<dd>model = lda(x,ncomp,options)</dd>
<dd>pred = lda(x,model,options)</dd>
<dd>valid = lda(x,y,model,options)</dd></dl>
<p>Please note that the recommended way to build and apply a LDA model from the command line is to use the Model Object. Please see <a href="evrimodel_objects.html" title="EVRIModel Objects"> this wiki page on building and applying models using the Model Object</a>.
</p>
<h3><span class="mw-headline" id="Description">Description</span></h3>
<p>Linear Discriminant Analysis (LDA) is a supervised machine learning method for classification and dimensionality reduction. It works by finding the linear combinations of features that best separate two or more classes of samples. The main idea is to project the data onto a lower-dimensional space to maximize the separation between different classes while minimizing the intra-class separation of the samples. LDA assumes that the data is normally or Gaussian distributed and classes have the same covariance matrix, but LDA has been proven effective in other scenarios where the assumptions are not strictly met. We have included two solvers for LDA: ‘eig’ and ‘svd’ (default). 
</p>
<ul><li><b>Generalized Eigenvalue Problem (‘eig’ solver)</b>: The 'eig' solver operates by computing the eigenvectors and eigenvalues of the scatter matrices, using these eigenvectors to project data onto a lower-dimensional space. This approach is more suitable when the number of variables (features) is smaller than the number of samples, offering better numerical stability in such scenarios. However, it can struggle with singular or nearly singular scatter matrices, a situation often encountered in datasets where variables far outnumber samples or when multicollinearity is present,e.g. spectra.</li></ul>
<dl><dd><b>Regularization for the 'eig' solver</b>:To improve model’s performance and stability of the ‘eig’ solver, we have adopted ridge regularization into our LDA implementation. Ridge (L2) regularization involves adding a small value λ (regularization parameter or penalty) to the diagonal elements of the within-class scatter matrix. This addition helps prevent the matrix from being singular, a common issue in datasets with either more variables than samples or with highly collinear variables (e.g. spectra). The benefit of this regularization is twofold: it not only stabilizes the LDA calculations, especially in high-dimensional spaces, but also reduces the risk of overfitting, thereby enhancing the model’s ability to generalize to new data. Regularization is applied by <b>default</b> with a <b>lambda value λ=0.001</b>. This value typically works well with auto-scaled data, but λ must be optimized for any dataset. To turn off regularization, simply make λ = 0.</dd></dl>
<dl><dd><b>For example</b>, calibrating an LDA model with the mean-centered data of the OliveOilData.mat dataset will result in an unstable LDA with lambda set to zero, e.g. eigenvalues are extremely large. Repeating the calculation with the default λ value 0.001 produces a robust LDA model.</dd></dl>
<ul><li><b>Singular Value Decomposition (‘svd’ solver) (Default)</b>: On the other hand, the 'svd' solver utilizes singular value decomposition, which doesn't explicitly compute scatter matrices, making it more robust in handling singular or nearly singular matrices. This method is more numerically stable and is better suited for high-dimensional data or sparse datasets. While potentially more computationally demanding, especially for larger datasets, 'svd' is generally preferred in cases where numerical stability and handling of a higher number of features are critical.</li></ul>
<dl><dd><b>Choosing Between 'eig' and 'svd'</b></dd>
<dd>The choice between these two solvers often depends on the specific characteristics of the data at hand:
<ul><li>If the dataset is large and the number of features is significantly less than the number of samples, 'eig' might be a good choice.</li>
<li>For high-dimensional data, or in cases where numerical stability is a concern, 'svd' is usually preferred.</li></ul></dd>
<dd>In practical applications, it's often a good idea to experiment with both methods to see which one performs better for your specific dataset and problem.</dd></dl>
<h4><span class="mw-headline" id="Probability_Estimation_and_Classification">Probability Estimation and Classification</span></h4>
<p>In the LDA algorithm, the estimation of the probability of each sample belonging to each class is grounded in Bayes' Theorem. This theorem provides a way to update our probability estimates for a hypothesis (in this case, class membership) based on new evidence (the sample's features). 
The key steps are as follows:
</p>
<ul><li><b>Prior Probabilities</b>: The algorithm begins by establishing prior probabilities for each class. These priors can be either provided or calculated based on the frequency of each class in the training data.</li>
<li>For the <b>log-likelihood calculation</b>, LDA assumes that all classes are normally distributed; therefore, LDA uses a multivariate Gaussian density function to model each class. In a nutshell, the distance (Mahalonobis) between a sample and the mean of each class is calculated using the shared covariance matrix, which accounts for the exponential term in the Gaussian distribution.</li>
<li><b>Complete log-likelihood</b>: Bayes' Theorem combines the latter log-likelihoods with the class priors to calculate the complete log-likelihood. The complete (posterior) log-likelihood represents the updated beliefs about the sample's class membership after observing its features.</li>
<li><b>Probabilities</b>: To derive the probabilities, the calculated complete log-likelihoods are normalized for each sample using softmax across all classes to ensure the probabilities sum up to one. This normalization step is crucial for making the probabilities comparable and meaningful.</li>
<li><b>Classification</b>: The predicted class for each sample is determined by selecting the class with the highest probability. This decision reflects the class that is statistically “most probable”.</li></ul>
<h4><span class="mw-headline" id="Inputs">Inputs</span></h4>
<ul><li><b>x</b> = X-block (predictor block), class "double" or "dataset",</li>
<li><b>y</b> = Y-block
<ul><li>OPTIONAL if <b>x</b> is a dataset containing classes for sample mode (mode 1)</li>
<li>otherwise, <b>y</b> is one of the following:
<ul><li>(A) column vector of sample classes for each sample in <b>x</b></li>
<li>(B) a logical array with '1' indicating class membership for each sample (rows) in one or more classes (columns), or</li>
<li>(C) a cell array of class groupings of classes from the x-block data. For example: <tt> {[1 2][3]} </tt>would model classes 1 and 2 as a single group against class 3.</li></ul></li></ul></li>
<li><b>ncomp</b> = the number of used LDA components or discriminant functions (positive integer scalar).</li></ul>
<h4><span class="mw-headline" id="Optional_Inputs">Optional Inputs</span></h4>
<ul><li><b>options</b> = an optional input options structure.</li></ul>
<h4><span class="mw-headline" id="Outputs">Outputs</span></h4>
<ul><li><b>model</b> = standard model structure containing the LDA model.</li>
<li><b>pred</b> = structure array with predictions</li>
<li><b>valid</b> = structure array with predictions, includes known class information (Y block data) of test samples.</li></ul>
<h3><span class="mw-headline" id="Options">Options</span></h3>
<p><i>options</i> = a structure that can contain the following fields:
</p>
<ul><li><b>display</b>: [ 'off' | {'on'} ]      governs level of display to command window.</li>
<li><b>plots</b>: [ 'none' | {'final'} ]  governs level of plotting.</li>
<li><b>preprocessing</b>: {[] []}  preprocessing structures for x and y blocks (see PREPROCESS).</li>
<li><b>priorprob</b>: [ ] Vector of prior probabilities of observing each class. If any class prior is "Inf", the frequency of observation of that class in the calibration is used as its prior probability. If all priors are Inf, this has the effect of providing the fewest incorrect predictions assuming that the probability of observing a given class in future samples is similar to the frequency that class in the calibration set. The default [] uses all ones i.e. equal priors.</li>
<li><b>classset</b>:  [ 1 ] indicates which class set in x to use when no y-block is provided.</li>
<li><b>algorithm</b>: [ 'eig' | 'svd'] ‘svd’ is set as default</li>
<li><b>blockdetails</b>: [  'compact' | {'standard'} | 'all' ] level of detail (predictions, raw residuals, and calibration data) included in the model.</li></ul>
<dl><dd><ul><li>'All' = keep predictions, raw residuals for both X- &amp; Y-blocks as well as the X- &amp; Y-blocks themselves.</li></ul></dd></dl>
<ul><li><b>strictthreshold</b>: Probability threshold value to use in strict class assignment, see <a href="sample_classification_predictions.html#Class_Pred_Strict" title="Sample Classification Predictions">Sample_Classification_Predictions#Class_Pred_Strict</a>. Default = 0.5.</li>
<li><b>lambda</b>: [ 0.001 ] Regularization parameter only applied to the ‘eig’ solver.</li></ul>
<h3><span class="mw-headline" id="See_Also">See Also</span></h3>
<p><a href="analysis.html" title="Analysis">analysis</a>, <a href="compressmodel.html" title="Compressmodel">compressmodel</a>, <a href="crossval.html" title="Crossval">crossval</a>, <a href="discrimprob.html" title="Discrimprob">discrimprob</a>, <a href="knn.html" title="Knn">knn</a>, <a href="modelselector.html" title="Modelselector">modelselector</a>, <a href="plsda.html" title="Plsda">plsda</a>, <a href="plsdaroc.html" title="Plsdaroc">plsdaroc</a>, <a href="plsdthres.html" title="Plsdthres">plsdthres</a>, <a href="preprocess.html" title="Preprocess">preprocess</a>, <a href="simca.html" title="Simca">simca</a>, <a href="svmda.html" title="Svmda">svmda</a>, <a href="vip.html" title="Vip">vip</a>, <a href="evrimodel_objects.html" title="EVRIModel Objects">EVRIModel_Objects</a>
</p>
<!-- 
NewPP limit report
Cached time: 20240930132034
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.011 seconds
Real time usage: 0.013 seconds
Preprocessor visited node count: 28/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key newwiki_eigenvector_com:pcache:idhash:1832-0!canonical and timestamp 20240930132034 and revision id 12126.
 -->
</div>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://www.wiki.eigenvector.com/index.php?title=Lda&amp;oldid=12126">https://www.wiki.eigenvector.com/index.php?title=Lda&amp;oldid=12126</a>"</div></div>
		<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		

<nav id="p-personal" class="vector-menu mw-portlet mw-portlet-personal vector-user-menu-legacy" aria-labelledby="p-personal-label" role="navigation"  >
	<h3
		id="p-personal-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			

<nav id="p-namespaces" class="vector-menu mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-namespaces-label" role="navigation"  >
	<h3
		id="p-namespaces-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			

<nav id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-labelledby="p-variants-label"
	/>
	<label
		id="p-variants-label"
		 aria-label="Change language variant"
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			

<nav id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-views-label" role="navigation"  >
	<h3
		id="p-views-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Views</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected mw-list-item"><a href=""><span>Read</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		aria-labelledby="p-cactions-label"
	/>
	<label
		id="p-cactions-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			

		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="main_page.html"
			title="Visit the main page"></a>
	</div>
	

<nav id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation vector-menu-portal portal" aria-labelledby="p-navigation-label" role="navigation"  >
	<h3
		id="p-navigation-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Navigation</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-Main-Page" class="mw-list-item"><a href="main_page.html"><span>Main Page</span></a></li><li id="n-PLS_Toolbox/Solo" class="mw-list-item"><a href="software_user_guide.html"><span>PLS_Toolbox/Solo</span></a></li><li id="n-MIA_Toolbox/Solo+MIA" class="mw-list-item"><a href="mia_toolbox_user_guide.html"><span>MIA_Toolbox/Solo+MIA</span></a></li><li id="n-Solo_Predictor" class="mw-list-item"><a href="solo_predictor_user_guide.html"><span>Solo_Predictor</span></a></li><li id="n-Model_Exporter" class="mw-list-item"><a href="model_exporter_user_guide.html"><span>Model_Exporter</span></a></li><li id="n-DataSet-Object" class="mw-list-item"><a href="dataset_object.html"><span>DataSet Object</span></a></li><li id="n-Frequently-Asked-Questions" class="mw-list-item"><a href="evri_faq.html"><span>Frequently Asked Questions</span></a></li><li id="n-Eigenvector-Homepage" class="mw-list-item"><a href="http://www.eigenvector.com/" rel="nofollow"><span>Eigenvector Homepage</span></a></li><li id="n-MediaWiki-Help" class="mw-list-item"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents"><span>MediaWiki Help</span></a></li></ul>
		
	</div>
</nav>

	

<nav id="p-tb" class="vector-menu mw-portlet mw-portlet-tb vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation"  >
	<h3
		id="p-tb-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="" title="More information about this page"><span>Page information</span></a></li></ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 6 December 2023, at 16:32.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="eigenvector_research_documentation_wiki_privacy_policy.html">Privacy policy</a></li>
	<li id="footer-places-about"><a href="eigenvector_research_documentation_wiki_about.html">About Eigenvector Research Documentation Wiki</a></li>
	<li id="footer-places-disclaimer"><a href="eigenvector_research_documentation_wiki_general_disclaimer.html">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></li>
</ul>

</footer>


<br/></body>
</html>