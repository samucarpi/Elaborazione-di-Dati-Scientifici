<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Wlsbaseline - Eigenvector Research Documentation Wiki</title>



    <link rel="stylesheet" href="load.css" media="screen" />        
  

<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href=""/>
<meta name="generator" content="MediaWiki 1.39.6"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="viewport" content="width=1000"/>
<link rel="icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Eigenvector Research Documentation Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://www.wiki.eigenvector.com/api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="Eigenvector Research Documentation Wiki Atom feed" href=""/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Wlsbaseline rootpage-Wlsbaseline skin-vector action-view skin-vector-legacy vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading"><a href="https://wiki.eigenvector.com/index.php?title=Wlsbaseline"><span class="mw-page-title-main">Wlsbaseline</span></a></h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Eigenvector Research Documentation Wiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Purpose"><span class="tocnumber">1</span> <span class="toctext">Purpose</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Synopsis"><span class="tocnumber">2</span> <span class="toctext">Synopsis</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Description"><span class="tocnumber">3</span> <span class="toctext">Description</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Inputs"><span class="tocnumber">3.1</span> <span class="toctext">Inputs</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Outputs"><span class="tocnumber">3.2</span> <span class="toctext">Outputs</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Options"><span class="tocnumber">4</span> <span class="toctext">Options</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#See_Also"><span class="tocnumber">5</span> <span class="toctext">See Also</span></a></li>
</ul>
</div>

<h3><span class="mw-headline" id="Purpose">Purpose</span></h3>
<p>Weighted least squares baseline function.
</p>
<h3><span class="mw-headline" id="Synopsis">Synopsis</span></h3>
<dl><dd>[bldata,wts,baseline,vweights] = wlsbaseline(data,baseline,options)</dd>
<dd>[bldata,wts,baseline,vweights] = wlsbaseline(data,order,options)</dd>
<dd>[bldata] = wlsbaseline(data,lambda,options);  %Whittaker</dd></dl>
<h3><span class="mw-headline" id="Description">Description</span></h3>
<p>Subtracts a baseline (or other signal) from a spectrum (row) using an iterative asymmetric least squares algorithm. Points with residuals &lt;0 are up-weighted at each iteration of the least squares fitting (this corresponds to the default options.trbflag='bottom'). The result is a robust "non-negaitve" residual fit when residuals of significant amplitude are present (i.e., signal is present on a background).
</p><p>There are several different filters are available, defined using the "filter" option:
</p>
<dl><dd><ul><li>'basis' = baseline subtraction using either specified vectors, or a polynomial basis. This algorithms is generally slower but introduces fewer artifacts.</li>
<li>'whittaker' = baseline subtraction using the Eilers' method based on a Whittaker filter. This algorithm is fast and handles more structured baselines, but can introduce peak shape artifacts (Eilers, Paul HC, and Hans FM Boelens. "Baseline correction with asymmetric least squares smoothing." Report <i>(Leiden University Medical Centre, 2005)</i> (2005). )</li></ul></dd></dl>
<h4><span class="mw-headline" id="Inputs">Inputs</span></h4>
<ul><li><b>data</b> = MxN data to be baselined - each ROW is baselined.</li>
<li><b>baseline</b> = 1xN reference spectrum (or KxN spectra) to use for baseline.</li></ul>
<dl><dd>An integer scalar value (order) corresponding to the order of polynomial baseline to use.</dd>
<dd>A scalar value (lambda) indicating required smoothness to use with algorithm 'whittaker' when using the Eilers' method of baseline removal.</dd></dl>
<h4><span class="mw-headline" id="Outputs">Outputs</span></h4>
<ul><li><b>bldata</b> = MxN baselined data.</li>
<li><b>wts</b> = Weights corresponding the amount of baseline removed from each spectrum (i.e. bldata = data - wts*baseline). If (baseline == polynomial order), wts contains the polynomial coefficients. Each row of (wts) can be used with the "baseline" output (see below) to obtain the baseline removed from the corresponding row of data. Note that wts can also be used with the POLYVAL function to reconstruct the baseline, however, a normalization factor of 1./sqrt(n) must be used on each baseline to correct for the number of variables (n).</li>
<li><b>baseline</b> = Baseline used for each spectrum. Note: this is the input (baseline) or polynomial basis.</li>
<li><b>vweights</b> = Variable weights used for each spectrum. Indicates the weighting used on each variable in each spectrum.</li></ul>
<h3><span class="mw-headline" id="Options">Options</span></h3>
<ul><li><b>dim</b>: [2] Dimension (mode) of data to baseline.</li>
<li><b>plots</b>&#160;:  [{'none'} | 'debug' | 'intermediate' | 'final'] governs plots</li>
<li><b>filter</b>&#160;: [ 'basis' | 'whittaker' ] governs baseline filter type.
<ul><li>'basis' uses a set of basis vectors fit to each spectrum. Input (baseline) specifies either a polynomial order or the specific baselines to use.</li>
<li>'whittaker' uses the Whittaker piecewise filter. Input (baseline) specifies the lambda smoothness.</li></ul></li>
<li><b>weightmode</b>&#160;:  [ {1} |  2 ] flag indicating which weighting mode to use:
<ul><li><b>Mode 1</b> = Power method. Negative residuals are weighted up by the power of <span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle 10^{option.negw}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mn>10</mn>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>o</mi>
            <mi>p</mi>
            <mi>t</mi>
            <mi>i</mi>
            <mi>o</mi>
            <mi>n</mi>
            <mo>.</mo>
            <mi>n</mi>
            <mi>e</mi>
            <mi>g</mi>
            <mi>w</mi>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle 10^{option.negw}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bfb5e6d21f015fd60aef94022ad7c69db0bd56cd" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:11.302ex; height:2.676ex;" alt="{\displaystyle 10^{option.negw}}"/></span>. All residuals are then raised to the power of (option.power)</li>
<li><b>Mode 2</b> = T squared method. Negative residuals are weighted up by the extent to which the surpass an estimate of the noise limit and the approximate t-limit defined by (option.tsqlim)</li></ul></li>
<li><b>trbflag</b>&#160;:  [ 'bottom' | 'top' ] baseline to top or bottom of data</li>
<li><b>negw</b>&#160;:  {1} deweighting scale of negative values (<span class="mwe-math-element"><span class="mwe-math-mathml-inline mwe-math-mathml-a11y" style="display: none;"><math xmlns="http://www.w3.org/1998/Math/MathML"  alttext="{\displaystyle 10^{negw}}">
  <semantics>
    <mrow class="MJX-TeXAtom-ORD">
      <mstyle displaystyle="true" scriptlevel="0">
        <msup>
          <mn>10</mn>
          <mrow class="MJX-TeXAtom-ORD">
            <mi>n</mi>
            <mi>e</mi>
            <mi>g</mi>
            <mi>w</mi>
          </mrow>
        </msup>
      </mstyle>
    </mrow>
    <annotation encoding="application/x-tex">{\displaystyle 10^{negw}}</annotation>
  </semantics>
</math></span><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/f1088d5a677e774fecd3de70db974af6b7e62562" class="mwe-math-fallback-image-inline" aria-hidden="true" style="vertical-align: -0.338ex; width:6.275ex; height:2.343ex;" alt="{\displaystyle 10^{negw}}"/></span>) (used only for weightmode = 1),</li>
<li><b>power</b>&#160;:  {2} exponential amplification of residuals (used only for weightmode = 1),</li>
<li><b>p</b>&#160;: {0.001} asymmetry (used only with algorithm = 'whittaker'),</li>
<li><b>tsqlim</b>&#160;:  [0.99] t-test confidence limit for significant negative residuals which need to be up-weighted. (used only for weightmode = 2).</li>
<li><b>nonneg</b>&#160;:  ['no'|{'yes'}] flag to force non-negative baseline weighting, most often used when "real" spectra are used for baslineing and they should not be "flipped" by a negative weighting. Using nonneg = 'yes', WLSBASELINE an be used as a partial CLS prediction to estimate the concentration of a species when not all species' pure component spectra are known.</li>
<li><b>delta</b>&#160;:  [1e-4] change-of-fit convergence criterion. Iterations are stopped when the relative change in fit is less than this value.</li>
<li><b>maxiter</b>&#160;:  [100] maximum iterations allowed per spectrum,</li>
<li><b>maxtime</b>&#160;:  [600] maximum time (in seconds) permitted for baselining of all data.</li></ul>
<h3><span class="mw-headline" id="See_Also">See Also</span></h3>
<p><a href="baseline.html" title="Baseline">baseline</a>, <a href="baselinew.html" title="Baselinew">baselinew</a>
</p>
<!-- 
NewPP limit report
Cached time: 20240930051622
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.114 seconds
Real time usage: 0.610 seconds
Preprocessor visited node count: 30/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 72/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key newwiki_eigenvector_com:pcache:idhash:281-0!canonical and timestamp 20240930051622 and revision id 2728.
 -->
</div>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://www.wiki.eigenvector.com/index.php?title=Wlsbaseline&amp;oldid=2728">https://www.wiki.eigenvector.com/index.php?title=Wlsbaseline&amp;oldid=2728</a>"</div></div>
		<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		

<nav id="p-personal" class="vector-menu mw-portlet mw-portlet-personal vector-user-menu-legacy" aria-labelledby="p-personal-label" role="navigation"  >
	<h3
		id="p-personal-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			

<nav id="p-namespaces" class="vector-menu mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-namespaces-label" role="navigation"  >
	<h3
		id="p-namespaces-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			

<nav id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-labelledby="p-variants-label"
	/>
	<label
		id="p-variants-label"
		 aria-label="Change language variant"
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			

<nav id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-views-label" role="navigation"  >
	<h3
		id="p-views-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Views</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected mw-list-item"><a href=""><span>Read</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		aria-labelledby="p-cactions-label"
	/>
	<label
		id="p-cactions-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			

		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="main_page.html"
			title="Visit the main page"></a>
	</div>
	

<nav id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation vector-menu-portal portal" aria-labelledby="p-navigation-label" role="navigation"  >
	<h3
		id="p-navigation-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Navigation</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-Main-Page" class="mw-list-item"><a href="main_page.html"><span>Main Page</span></a></li><li id="n-PLS_Toolbox/Solo" class="mw-list-item"><a href="software_user_guide.html"><span>PLS_Toolbox/Solo</span></a></li><li id="n-MIA_Toolbox/Solo+MIA" class="mw-list-item"><a href="mia_toolbox_user_guide.html"><span>MIA_Toolbox/Solo+MIA</span></a></li><li id="n-Solo_Predictor" class="mw-list-item"><a href="solo_predictor_user_guide.html"><span>Solo_Predictor</span></a></li><li id="n-Model_Exporter" class="mw-list-item"><a href="model_exporter_user_guide.html"><span>Model_Exporter</span></a></li><li id="n-DataSet-Object" class="mw-list-item"><a href="dataset_object.html"><span>DataSet Object</span></a></li><li id="n-Frequently-Asked-Questions" class="mw-list-item"><a href="evri_faq.html"><span>Frequently Asked Questions</span></a></li><li id="n-Eigenvector-Homepage" class="mw-list-item"><a href="http://www.eigenvector.com/" rel="nofollow"><span>Eigenvector Homepage</span></a></li><li id="n-MediaWiki-Help" class="mw-list-item"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents"><span>MediaWiki Help</span></a></li></ul>
		
	</div>
</nav>

	

<nav id="p-tb" class="vector-menu mw-portlet mw-portlet-tb vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation"  >
	<h3
		id="p-tb-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="" title="More information about this page"><span>Page information</span></a></li></ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 10 June 2014, at 22:23.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="eigenvector_research_documentation_wiki_privacy_policy.html">Privacy policy</a></li>
	<li id="footer-places-about"><a href="eigenvector_research_documentation_wiki_about.html">About Eigenvector Research Documentation Wiki</a></li>
	<li id="footer-places-disclaimer"><a href="eigenvector_research_documentation_wiki_general_disclaimer.html">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></li>
</ul>

</footer>


<br/></body>
</html>