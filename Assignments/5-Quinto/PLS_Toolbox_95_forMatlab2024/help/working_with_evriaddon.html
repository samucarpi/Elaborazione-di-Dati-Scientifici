<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Working With EVRIADDON - Eigenvector Research Documentation Wiki</title>



    <link rel="stylesheet" href="load.css" media="screen" />        
  

<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href=""/>
<meta name="generator" content="MediaWiki 1.39.6"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="viewport" content="width=1000"/>
<link rel="icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Eigenvector Research Documentation Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://www.wiki.eigenvector.com/api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="Eigenvector Research Documentation Wiki Atom feed" href=""/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Working_With_EVRIADDON rootpage-Working_With_EVRIADDON skin-vector action-view skin-vector-legacy vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading"><a href="https://wiki.eigenvector.com/index.php?title=Working_With_EVRIADDON"><span class="mw-page-title-main">Working With EVRIADDON</span></a></h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Eigenvector Research Documentation Wiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Object_Properties"><span class="tocnumber">1</span> <span class="toctext">Object Properties</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Examples"><span class="tocnumber">2</span> <span class="toctext">Examples</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Adding_a_Custom_Import_Function"><span class="tocnumber">2.1</span> <span class="toctext">Adding a Custom Import Function</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Adding_an_PLOTGUI_Toolbar_Button"><span class="tocnumber">2.2</span> <span class="toctext">Adding an PLOTGUI Toolbar Button</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Adding_an_Analysis_Toolbar_Button"><span class="tocnumber">2.3</span> <span class="toctext">Adding an Analysis Toolbar Button</span></a></li>
</ul>
</li>
</ul>
</div>

<p>The <b><a href="evriaddon.html" title="Evriaddon">evriaddon</a></b> object allows for existing functions to "query" for additional functionality. A good example is the <a href="editds_importmethods.html" title="Editds importmethods">editds_importmethods</a>  function that defines import methods. This function adds additional import methods to those included with PLS_Toolbox.
</p>
<h2><span class="mw-headline" id="Object_Properties">Object Properties</span></h2>
<p>Querying evriaddon_connection will return an object which has help built into it:
</p>
<pre>obj = evriaddon_connection</pre>
<p>at the end of the object's entrypoint listing it says:
</p>
<pre>   Entry Points:
       analysistypes                       &#160;: ---
       importmethods                       &#160;: ---
       importmethods_filter                &#160;: ---
       savemodelas                         &#160;: ---
       preprocess                          &#160;: ---
       browse_post_gui_init                &#160;: ---
       browse_shortcuts                    &#160;: ---
       ...
       load_postload                       &#160;: ---
       autoimport_postload                 &#160;: ---
       addsourceinfo_prefilter             &#160;: ---
       plotgui_toolbar                     &#160;: ---
    Entrypoint Help: use "obj.help.entrypoint"</pre>
<p>for example:
</p>
<pre>&gt;&gt; obj.help.analysis_calcmodel_callback
ans =
    fn(fig,eventdata,handles);  %perform user-specified events when calc model is clicked (calc or apply).</pre>
<p><br />
The help specifies what the function I/O is expected to be for the given entry point.
</p>
<h2><span class="mw-headline" id="Examples">Examples</span></h2>
<p>NOTE: Some of these examples add toolbar buttons. A list of available icons can be seen with the following command. These icons should be used as the first input to the button definition. 
</p>
<pre>toolbar icons</pre>
<h3><span class="mw-headline" id="Adding_a_Custom_Import_Function">Adding a Custom Import Function</span></h3>
<ul><li>Create your import function using <a href="editds_userimport.html" title="Editds userimport">editds_userimport</a> as a template.</li></ul>
<ul><li>Since there's already an entry in the <b>@evriaddon/addon_pls_toolbox.m</b> file that points to <a href="editds_importmethods.html" title="Editds importmethods">editds_importmethods</a> we simply need to add the function created in step one to the list of import methods within <a href="editds_importmethods.html" title="Editds importmethods">editds_importmethods</a>. Edit this file and add an entry for the new import method.</li></ul>
<ul><li>Your entry will show up the next time you use the import menu item.</li></ul>
<h3><span class="mw-headline" id="Adding_an_PLOTGUI_Toolbar_Button">Adding an PLOTGUI Toolbar Button</span></h3>
<p>In this example we'll add a button to the plotgui toolbar (the toolbar that appears on the "target" figure) that creates a static plot.
</p>
<ul><li>The function that uses evriaddon in this situation is plotgui_toolbar.m. Opening this function we can see that to add a button we need to add an entry to the list (n x 7 cell array of strings) of buttons with the following format:</li></ul>
<table class="wikitable" border="1" cellpadding="3" style="width:100px; height:100px">
<tbody><tr>
<th width="100pt"><b>icon</b>
</th>
<th width="100pt"><b>tag</b>
</th>
<th width="100pt"><b>callback</b>
</th>
<th width="100pt"><b>enable/disable</b>
</th>
<th width="100pt"><b>tooltip</b>
</th>
<td><b>separator on/off</b>
</td>
<td><b>push/toggle button</b>
</td></tr>
</tbody></table>
<p>Create a function (in the PLS_Toolbox/utilities folder) named "myplotguibuttons.m". All the function will do is take the existing button list and add an entry for an additional button. Looking at where plotgui_toolbar.m calls evriaddon I know it passes two inputs, the button list (btn) and figure handle (targfig). We ignore targfig for now because we don't need any figure information. The code should then be simply:
</p>
<pre>function btn = myplotguibuttons(btn,targfig)
%MYPLOTGUIBUTTONS Utility function to add toolbar buttons.

btn = [btn
  {
  'plot'  'makestaticplot'  'plotgui(''menuselection'',''ViewSpawn'')'  'enable' 'Create a static plot.' 'on'  'push'
  }];</pre>
<p>I chose the "plot" icon, a unique tag name, a simple plotgui command, and appropriate values for the rest of the settings.
</p><p><br />
</p>
<ul><li>In the PLS_Toolbox/utilities/@evriaddon folder, open the addon_pls_toolbox.m file. Here, add an "entry point" for plotgui_toolbar and assign it the function handle of the function we created above. It should look similar to:</li></ul>
<pre>...

out.priority = 1;
out.importmethods = @editds_importmethods;
out.preprocess    = @preprouser;
out.plotgui_toolbar = @myplotguibuttons;

...</pre>
<ul><li>Test your new button:</li></ul>
<pre>load arch
plogtgui(arch)
</pre>
<p><br />
</p>
<h3><span class="mw-headline" id="Adding_an_Analysis_Toolbar_Button">Adding an Analysis Toolbar Button</span></h3>
<p>Building off of the above example, a toolbar button can be added to the analysis window. Two functions will be needed, one to create the button and one to be called by the button. Similar steps will be followed:
</p>
<ul><li>Create a function (in the PLS_Toolbox/utilities folder) named "myanalysis_toolbarfcn.m". This function will add a toolbar button if the analysis is PCA or MPCA. Looking at where toobar_buttonsets.m calls evriaddon, it passes two inputs, the current analysis method and button list. If the current method is PCA or MPCA a button will be added that calls into a custom plotting function with the figure handle.</li></ul>
<pre>function mylist = myanalysis_toolbarfcn(varargin)
%MYANALYSIS_TOOLBARFCN - Utility function to add toolbar buttons.

current_analysis = varargin{1};
mylist = varargin{2};

if ismember(current_analysis,{'pca' 'mpca'})
  mylist = [mylist
    {
    'coffee'  'CustomPlot'  'myanalysis_plot(gcbf)'  'enable' 'Create a custom plot.' 'on'  'push'
    }];
end
</pre>
<ul><li>In the PLS_Toolbox/utilities/@evriaddon folder, open the addon_pls_toolbox.m file. Here, add an "entry point" for toolbar_buttonsets and assign it the function handle of the function we created in step above. It should look similar to:</li></ul>
<pre>...

out.priority = 1;
out.importmethods = @editds_importmethods;
out.preprocess    = @preprouser;
out.toolbar_buttonsets = @myanalysis_toolbarfcn;

...</pre>
<ul><li>Create the myanalysis_plot function. In this example function it shows how to get data and the model from the analysis window and then link and plot data:</li></ul>
<pre>function out = myanalysis_plot(analysis_figure)
%MYANALYSIS_PLOT - Test custom plot for analysis. 

handles = guidata(analysis_figure);
myxblock = analysis('getobjdata','xblock',handles);
mymodl = analysis('getobjdata','model',handles);

if isempty(myxblock) | isempty(mymodl)
  return
end

%Get prepro from model.
ppx = mymodl.detail.preprocessing{1};

%Apply prepro to xblock and create new dataset object of data to be
%plotted.
myxblock_pp = preprocess('apply',ppx,myxblock);

%Add the data to analysis and get "id" back that we can link with. 
dataid_pp = analysis('setobjdata','myxblock_ppdata',handles,myxblock_pp);

%Link data back to x-block.
xdataid = analysis('getobj','xblock',handles);
linkmap = [1 1];%Link first mode, coud add second mode as well. linkmap = [[1;2] [1;2]]
linkshareddata(xdataid,'add',dataid_pp,'analysis',struct('linkmap',linkmap,'isdependent',1));
linkshareddata(dataid_pp,'add',xdataid,'analysis',struct('linkmap',linkmap));

%Make plot with plotgui.
plotgui('new',dataid_pp,'plotby',0,'name','My PrePro XData');
</pre>
<ul><li>Test the new button by opening PCA and trying it.</li></ul>
<!-- 
NewPP limit report
Cached time: 20240930205511
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.007 seconds
Real time usage: 0.010 seconds
Preprocessor visited node count: 64/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 2898/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key newwiki_eigenvector_com:pcache:idhash:750-0!canonical and timestamp 20240930205511 and revision id 11248.
 -->
</div>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://www.wiki.eigenvector.com/index.php?title=Working_With_EVRIADDON&amp;oldid=11248">https://www.wiki.eigenvector.com/index.php?title=Working_With_EVRIADDON&amp;oldid=11248</a>"</div></div>
		<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		

<nav id="p-personal" class="vector-menu mw-portlet mw-portlet-personal vector-user-menu-legacy" aria-labelledby="p-personal-label" role="navigation"  >
	<h3
		id="p-personal-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			

<nav id="p-namespaces" class="vector-menu mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-namespaces-label" role="navigation"  >
	<h3
		id="p-namespaces-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			

<nav id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-labelledby="p-variants-label"
	/>
	<label
		id="p-variants-label"
		 aria-label="Change language variant"
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			

<nav id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-views-label" role="navigation"  >
	<h3
		id="p-views-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Views</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected mw-list-item"><a href=""><span>Read</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		aria-labelledby="p-cactions-label"
	/>
	<label
		id="p-cactions-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			

		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="main_page.html"
			title="Visit the main page"></a>
	</div>
	

<nav id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation vector-menu-portal portal" aria-labelledby="p-navigation-label" role="navigation"  >
	<h3
		id="p-navigation-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Navigation</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-Main-Page" class="mw-list-item"><a href="main_page.html"><span>Main Page</span></a></li><li id="n-PLS_Toolbox/Solo" class="mw-list-item"><a href="software_user_guide.html"><span>PLS_Toolbox/Solo</span></a></li><li id="n-MIA_Toolbox/Solo+MIA" class="mw-list-item"><a href="mia_toolbox_user_guide.html"><span>MIA_Toolbox/Solo+MIA</span></a></li><li id="n-Solo_Predictor" class="mw-list-item"><a href="solo_predictor_user_guide.html"><span>Solo_Predictor</span></a></li><li id="n-Model_Exporter" class="mw-list-item"><a href="model_exporter_user_guide.html"><span>Model_Exporter</span></a></li><li id="n-DataSet-Object" class="mw-list-item"><a href="dataset_object.html"><span>DataSet Object</span></a></li><li id="n-Frequently-Asked-Questions" class="mw-list-item"><a href="evri_faq.html"><span>Frequently Asked Questions</span></a></li><li id="n-Eigenvector-Homepage" class="mw-list-item"><a href="http://www.eigenvector.com/" rel="nofollow"><span>Eigenvector Homepage</span></a></li><li id="n-MediaWiki-Help" class="mw-list-item"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents"><span>MediaWiki Help</span></a></li></ul>
		
	</div>
</nav>

	

<nav id="p-tb" class="vector-menu mw-portlet mw-portlet-tb vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation"  >
	<h3
		id="p-tb-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="" title="More information about this page"><span>Page information</span></a></li></ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 22 March 2021, at 10:05.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="eigenvector_research_documentation_wiki_privacy_policy.html">Privacy policy</a></li>
	<li id="footer-places-about"><a href="eigenvector_research_documentation_wiki_about.html">About Eigenvector Research Documentation Wiki</a></li>
	<li id="footer-places-disclaimer"><a href="eigenvector_research_documentation_wiki_general_disclaimer.html">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></li>
</ul>

</footer>


<br/></body>
</html>