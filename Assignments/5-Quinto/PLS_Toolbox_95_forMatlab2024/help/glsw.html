<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Glsw - Eigenvector Research Documentation Wiki</title>



    <link rel="stylesheet" href="load.css" media="screen" />        
  

<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href=""/>
<meta name="generator" content="MediaWiki 1.39.6"/>
<meta name="format-detection" content="telephone=no"/>
<meta name="viewport" content="width=1000"/>
<link rel="icon" href="favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.php" title="Eigenvector Research Documentation Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://www.wiki.eigenvector.com/api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="Eigenvector Research Documentation Wiki Atom feed" href=""/>
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Glsw rootpage-Glsw skin-vector action-view skin-vector-legacy vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading"><a href="https://wiki.eigenvector.com/index.php?title=Glsw"><span class="mw-page-title-main">Glsw</span></a></h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Eigenvector Research Documentation Wiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Purpose"><span class="tocnumber">1</span> <span class="toctext">Purpose</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Synopsis"><span class="tocnumber">2</span> <span class="toctext">Synopsis</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Description"><span class="tocnumber">3</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Options"><span class="tocnumber">4</span> <span class="toctext">Options</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#See_Also"><span class="tocnumber">5</span> <span class="toctext">See Also</span></a></li>
</ul>
</div>

<h3><span class="mw-headline" id="Purpose">Purpose</span></h3>
<p>Calculate or apply Generalized Least Squares weighting (GLSW), External Parameter Orthogonalization (EPO), and Extended Mixture Model (EMM) filters. See also <a href="declutter_settings_window.html" title="Declutter Settings Window">Declutter Settings Window</a>.
</p>
<h3><span class="mw-headline" id="Synopsis">Synopsis</span></h3>
<dl><dd>modl = glsw(x,a);             %GLS on matrix</dd>
<dd>modl = glsw(x1,x2,a);         %GLS between two data sets</dd>
<dd>modl = glsw(x,y,a);           %GLS on matrix in groups based on y</dd>
<dd>modl = glsw(modl,a);          %Update model to use a new value</dd>
<dd>xt   = glsw(newx,modl,<i>options</i>);       %apply correction</dd>
<dd>xt   = glsw(newx,modl,<i>a</i>);             %apply correction</dd></dl>
<h3><span class="mw-headline" id="Description">Description</span></h3>
<p>This filter uses a Generalized Least Squares (GLS) based weighting strategy to down-weight features identified from the singular value decomposition of a clutter data matrix. Clutter is context dependent and the cases are described in detail below.
</p><p>If the singular value decomposition (SVD) of the input matrix <tt>x</tt> is <b>X</b> = <b>USV</b><sup>T</sup> then the deweighting matrix is estimated with the following pseudo-inverse:
</p>
<dl><dd><b>W</b>= <b>U</b>diag( sqrt(1/(diag(<b>S</b>)/a<sup>2</sup>+1) )<b>V</b><sup>T</sup> = <b>US</b><sub>inv</sub><b>V</b><sup>T</sup></dd></dl>
<p>where <b>S</b><sub>inv</sub> corresponds to a regularized inverse of the singular values. The adjustable parameter a is a regularization parameter used to scale the singular values prior to calculating their inverse. As a gets larger, the extent of deweighting decreases (because <b>S</b><sub>inv</sub> approaches 1). As a gets smaller (e.g., 0.1  decreasing to 0.001) the extent of deweighting increases (because <b>S</b><sub>inv</sub> approaches 0) and the deweighting includes increasing amounts of the the directions represented by smaller singular values. A good initial guess for a is 1x10<sup>-2</sup> but will vary depending on the covariance structure of <b>X</b> and the specific application. It is recommended that a number of different values be investigated using an external cross-validation metric for performance evaluation.
</p><p>For more information see:
</p>
<dl><dd>H. Martens, M. Høy, B.M. Wise, R. Bro and P.B. Brockhoff, "Pre-whitening of data by covariance-weighted pre-processing," J. Chemom., <b>17</b>(3), 153-165, 2003.</dd></dl>
<p>This function will also perform EPO (External Parameter Orthogonalization) which is GLSW with a filter built from a specific number of singular vectors rather than the weighting scheme described above and EMM (Extended Mixture Modeling) filtering which is EPO orthogonalizing to all available singular vectors. To perform EPO, a negative integer is supplied in place of (a) where (-a) specifies the number of singular vectors to include in the filter. This is GLSW with a square-wave function for the deweighting i.e., the first a singular values of <b>S</b><sub>inv</sub> are set to zero and the remaining singular values are set to 1. To perform EMM, a negative infinity (-inf) is supplied in place of (a).
</p><p>Finally, an alternative method to use GLSW is in quantitative analysis where a continuous y-variable is used to develop pseudo-groupings of samples in <b>X</b> by comparing the differences in the corresponding <b>y</b> values. This is referred to as the "gradient method" because it utilizes a gradient of the sorted <b>X</b>- and <b>y</b>-blocks to calculate a covariance matrix. For more information on this method, see the <a href="advanced_preprocessing__multivariate_filtering.html" title="Advanced Preprocessing: Multivariate Filtering">Advanced Preprocessing: Multivariate Filtering</a> page or the paper:
</p>
<dl><dd>B. M. Zorzetti, J. M. Shaver, J. J. Harynuk, "Estimation of the age of a weathered mixture of volatile organic compounds" Analytica Chimica Acta, <b>694</b>, 31–37, 2011.</dd></dl>
<p>For calibration of the GLSW model <tt>modl</tt>, inputs can be provided by one of four methods: 
</p><p><b>1)</b> <tt>modl = glsw(x,a)</tt>
</p>
<dl><dd><dl><dd><tt>x</tt> = a clutter data or covariance matrix containing features to be downweighted, and</dd>
<dd><tt>a</tt> = scalar regularization parameter that governs downweighting {default = 1e-2}.</dd></dl></dd></dl>
<dl><dd><dl><dd><b>Note</b>: If <tt>x</tt> is a dataset with classes, differences within <i>each class</i> are used for down-weighting (i.e., intra-class variance is considered clutter). This reduces intra-class variation but ignores the inter-class variation. Only classes with class numbers &gt;0 are included in the clutter calculation (see DataSet object for more information).</dd></dl></dd></dl>
<p><b>2)</b> <tt>modl = glsw(x1,x2,a)</tt>
</p>
<dl><dd><dl><dd><tt>x1</tt> = a <i>M</i> by <i>N</i> data matrix and</dd>
<dd><tt>x2</tt> = a <i>M</i> by <i>N</i> data matrix.
<dl><dd>The clutter is defined as x = x1-x2; the row-by-row differences between x1 and x2. The input data represents two or more measured populations which should otherwise be the same (e.g., the same samples measured on two different analyzers or using different solvents).</dd></dl></dd>
<dd><tt>a</tt> = scalar regularization parameter that governs downweighting {default = 1e-2}.</dd></dl></dd></dl>
<p><b>3)</b> <tt>modl = glsw(x,y,a)</tt>
</p>
<dl><dd><dl><dd><tt>x</tt> = a <i>M</i> by <i>N</i> data matrix,</dd>
<dd><tt>y</tt> = column vector of integers with <i>M</i> rows specifing sample groups in x within which differences should be downweighted.</dd>
<dd><b>Note</b>: This method is identical to method (1) when classes of the <b>X</b>-block are used to identify groups. The only difference is that the groups are identified from the separate input <tt>y</tt> instead of the dataset classes. If <tt>y</tt> is empty, this defaults to method (1) without class information where <tt>x</tt> is then defined as the clutter data matrix.</dd>
<dd><tt>a</tt> = scalar regularization parameter that governs downweighting {default = 1e-2}.</dd></dl></dd></dl>
<p><b>4)</b> <tt>modl = glsw(x,y,a)</tt>
</p>
<dl><dd><dl><dd><tt>x</tt> = a <i>M</i> by <i>N</i> data matrix,</dd>
<dd><tt>y</tt> = column vector with <i>M</i> rows specifying a <b>y</b>-block continuous variable. In this input, the "gradient method" is used to identify similar samples and downweight differences between them. See also the gradientthreshold option below.</dd>
<dd><tt>a</tt> = scalar regularization parameter that governs downweighting {default = 1e-2}.</dd></dl></dd></dl>
<p>The input <tt>a</tt> can be replaced with an options structure (see Options below).
</p><p>When applying a GLSW model the inputs are <tt>newx</tt>, the <b>X</b>-block to be deweighted, and <tt>modl</tt>, a GLSW model structure.
</p><p>Outputs are <tt>modl</tt>, a GLSW model structure, and <tt>xt</tt>, the deweighted <b>X</b>-block.
</p>
<h3><span class="mw-headline" id="Options">Options</span></h3>
<p>An options structure can be used in place of (a) for any call or as the third input in an apply call. This structure consists of any of the fields:
</p>
<ul><li><b>a</b>: [ 0.02 ] scalar parameter limiting downweighting {default = 1e-2},</li></ul>
<ul><li><b>meancenter</b>: [ 'no' | {'yes'} ] For single x-block modes only: governs the calculation of a mean of each group of data before calculating the covariance. If set to <i>no</i>, the filter will include the offset of each group. This is equivalent to saying the offset in the data is part of  the clutter which should be removed.</li></ul>
<ul><li><b>applymean</b>:  [ 'no' | {'yes'} ] governs the use of the mean difference calculated between two instruments (difference between two instruments mode). When appling a GLS filter to data collected on the x1 instrument, the mean should NOT be applied. Data collected on the SECOND instrument should have the mean applied.</li></ul>
<ul><li><b>gradientthreshold</b>: [ .25 ] "continuous variable" threshold fraction above which the column gradient method will be used with a continuous y. Usually, when (y) is supplied, it is assumed to be the identification of discrete groups of samples. However, when calibrating, the number of samples in each "group" is calculated and the fraction of samples in "singleton" groups (i.e. in thier own group) is determined.</li></ul>
<dl><dd><dl><dd>fraction = (\# Samples in Singleton Groups) / Total Samples</dd></dl></dd></dl>
<dl><dd>If this fraction is above the value specified by this option, (y) is considered a continuous variable (such as a concentration or other property to predict). In these cases, the "sample similarity" (a.k.a. "column gradient") method of calculating the covariance matrix will be used. Sample similarity method determines the down-weighting required based  mostly on samples which are the most similar (on the specified y-scale). Set to &gt;=1 to disable and to 0 (zero) to always use.</dd></dl>
<ul><li><b>xgradient</b>: [ {'no'} | 'yes' ] apply an x-block gradient filter before calculating the filter. This filter performs a derivative down the columns of the x-block accentuating differences between adjacent samples. For example: When samples are sorted by time, this creates a GLSW filter that down-weights differences in the short time scale while retaining long-scale differences.</li></ul>
<ul><li><b>xgradwindow</b>: [ 3 ] number of samples over which the xgradient should be taken (see xgradient option)</li></ul>
<ul><li><b>maxpcs</b>: [ 50 ] maximum number of components (factors) to allow in the GLSW model. Typically, the number of factors in incuded in a model will be the smallest of this number, the number of variables or the number of samples. Having a limit set here is useful when derriving a GLSW model from a large number of samples and variables. Often, a GLSW model effectively uses fewer than 20 components. Thus, this option can be used to keep the GLSW model smaller in size. It may, however, decrease its effectiveness if critical factors are not included in the model.</li></ul>
<ul><li><b>classset</b>: [ 1 ] indicates which class set in x to use when no y-block is provided.</li></ul>
<ul><li><b>maxperclass</b>: [inf] indicates the maximum number of samples from each class that should be used to calculate the filter when class-based filtering is being done. When &lt; inf, only the first "maxperclass" samples from each class are used to calculate the filter.</li></ul>
<ul><li><b>downweight</b>: [ 'no' | {'yes'} ] governs whether the filter will downweight identified features, or upweight them. Normally, "clutter" is identified and downweighted by a GLSW filter. However, GLSW filters can also be supplied with features that are of interest (signal) and this flag can be reversed causing GLSW to "upweight" thses signal features.</li></ul>
<h3><span class="mw-headline" id="See_Also">See Also</span></h3>
<p><a href="caltransfer.html" title="Caltransfer">caltransfer</a>, <a href="pca.html" title="Pca">pca</a>, <a href="pls.html" title="Pls">pls</a>, <a href="preprocess.html" title="Preprocess">preprocess</a>, <a href="osccalc.html" title="Osccalc">osccalc</a>
</p>
<!-- 
NewPP limit report
Cached time: 20240930093923
Cache expiry: 86400
Reduced expiry: false
Complications: [show‐toc]
CPU time usage: 0.011 seconds
Real time usage: 0.017 seconds
Preprocessor visited node count: 16/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key newwiki_eigenvector_com:pcache:idhash:115-0!canonical and timestamp 20240930093923 and revision id 1217.
 -->
</div>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://www.wiki.eigenvector.com/index.php?title=Glsw&amp;oldid=1217">https://www.wiki.eigenvector.com/index.php?title=Glsw&amp;oldid=1217</a>"</div></div>
		<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		

<nav id="p-personal" class="vector-menu mw-portlet mw-portlet-personal vector-user-menu-legacy" aria-labelledby="p-personal-label" role="navigation"  >
	<h3
		id="p-personal-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Personal tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			

<nav id="p-namespaces" class="vector-menu mw-portlet mw-portlet-namespaces vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-namespaces-label" role="navigation"  >
	<h3
		id="p-namespaces-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Namespaces</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			

<nav id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation"  >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox"
		aria-labelledby="p-variants-label"
	/>
	<label
		id="p-variants-label"
		 aria-label="Change language variant"
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			

<nav id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs vector-menu-tabs-legacy" aria-labelledby="p-views-label" role="navigation"  >
	<h3
		id="p-views-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Views</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected mw-list-item"><a href=""><span>Read</span></a></li></ul>
		
	</div>
</nav>

			

<nav id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options" >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox"
		aria-labelledby="p-cactions-label"
	/>
	<label
		id="p-cactions-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			

		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="main_page.html"
			title="Visit the main page"></a>
	</div>
	

<nav id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation vector-menu-portal portal" aria-labelledby="p-navigation-label" role="navigation"  >
	<h3
		id="p-navigation-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Navigation</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-Main-Page" class="mw-list-item"><a href="main_page.html"><span>Main Page</span></a></li><li id="n-PLS_Toolbox/Solo" class="mw-list-item"><a href="software_user_guide.html"><span>PLS_Toolbox/Solo</span></a></li><li id="n-MIA_Toolbox/Solo+MIA" class="mw-list-item"><a href="mia_toolbox_user_guide.html"><span>MIA_Toolbox/Solo+MIA</span></a></li><li id="n-Solo_Predictor" class="mw-list-item"><a href="solo_predictor_user_guide.html"><span>Solo_Predictor</span></a></li><li id="n-Model_Exporter" class="mw-list-item"><a href="model_exporter_user_guide.html"><span>Model_Exporter</span></a></li><li id="n-DataSet-Object" class="mw-list-item"><a href="dataset_object.html"><span>DataSet Object</span></a></li><li id="n-Frequently-Asked-Questions" class="mw-list-item"><a href="evri_faq.html"><span>Frequently Asked Questions</span></a></li><li id="n-Eigenvector-Homepage" class="mw-list-item"><a href="http://www.eigenvector.com/" rel="nofollow"><span>Eigenvector Homepage</span></a></li><li id="n-MediaWiki-Help" class="mw-list-item"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents"><span>MediaWiki Help</span></a></li></ul>
		
	</div>
</nav>

	

<nav id="p-tb" class="vector-menu mw-portlet mw-portlet-tb vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation"  >
	<h3
		id="p-tb-label"
		
		class="vector-menu-heading "
	>
		<span class="vector-menu-heading-label">Tools</span>
	</h3>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li><li id="t-permalink" class="mw-list-item"><a href="" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="" title="More information about this page"><span>Page information</span></a></li></ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 31 March 2015, at 13:40.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="eigenvector_research_documentation_wiki_privacy_policy.html">Privacy policy</a></li>
	<li id="footer-places-about"><a href="eigenvector_research_documentation_wiki_about.html">About Eigenvector Research Documentation Wiki</a></li>
	<li id="footer-places-disclaimer"><a href="eigenvector_research_documentation_wiki_general_disclaimer.html">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></li>
</ul>

</footer>


<br/></body>
</html>